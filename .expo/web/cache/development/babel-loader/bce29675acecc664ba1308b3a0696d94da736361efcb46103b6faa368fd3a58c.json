{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport styles from \"../../elements/style\";\n;\nimport * as SQLite from 'expo-sqlite';\nimport * as FileSystem from 'expo-file-system';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar DATABASE_NAME = 'smarthome.db';\nFileSystem.deleteAsync(FileSystem.documentDirectory + DATABASE_NAME).then(function () {\n  console.log('Deleted the previous database');\n}).catch(function (error) {\n  console.log('Error deleting the previous database:', error);\n});\nexport var initDatabase = function initDatabase() {\n  var db = SQLite.openDatabase('smarthome.db');\n  db.transaction(function (tx) {\n    tx.executeSql('CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT, password TEXT)');\n    tx.executeSql('INSERT INTO users (username, password) VALUES (?, ?)', ['user1', 'password1']);\n    tx.executeSql('INSERT INTO users (username, password) VALUES (?, ?)', ['user2', 'password2']);\n  });\n  window.addEventListener('beforeunload', function () {\n    SQLite.deleteDatabase('smarthome.db', function (result) {\n      if (result) {\n        console.log('All databases deleted successfully');\n      } else {\n        console.log('Failed to delete databases');\n      }\n    }, function (error) {\n      console.log('Error deleting databases:', error);\n    });\n  });\n  return db;\n};\nvar LoginScreen = function LoginScreen(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState(''),\n    _useState2 = _slicedToArray(_useState, 2),\n    username = _useState2[0],\n    setUsername = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    password = _useState4[0],\n    setPassword = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    msg = _useState6[0],\n    setMsg = _useState6[1];\n  var db = SQLite.openDatabase('smarthome.db');\n  var handleLogin = function () {\n    var _ref2 = _asyncToGenerator(function* (username, password) {\n      var db = initDatabase();\n      db.transaction(function (tx) {\n        tx.executeSql('SELECT username FROM users WHERE username = ? AND password = ?', [username, password], function (tx, _ref3) {\n          var _ref3$rows = _ref3.rows,\n            length = _ref3$rows.length,\n            _array = _ref3$rows._array;\n          if (length > 0) {\n            navigation.navigate('Home');\n          } else {\n            setMsg('Invalid username or password');\n            console.log(msg);\n          }\n        }, function (error) {\n          console.log(error);\n          return true;\n        });\n      });\n    });\n    return function handleLogin(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsxs(View, {\n    style: styles.container_login,\n    children: [_jsx(Text, {\n      style: styles.logo,\n      children: \"Login\"\n    }), _jsx(TouchableOpacity, {\n      style: styles.inputView,\n      children: _jsx(TextInput, {\n        style: styles.inputText,\n        placeholder: \"Username\",\n        placeholderTextColor: \"#003f5c\",\n        onChangeText: function onChangeText(text) {\n          return setUsername(text);\n        },\n        value: username\n      })\n    }), _jsx(TouchableOpacity, {\n      style: styles.inputView,\n      children: _jsx(TextInput, {\n        style: styles.inputText,\n        placeholder: \"Password\",\n        placeholderTextColor: \"#003f5c\",\n        secureTextEntry: true,\n        onChangeText: function onChangeText(text) {\n          return setPassword(text);\n        },\n        value: password\n      })\n    }), _jsx(TouchableOpacity, {\n      style: styles.loginBtn,\n      onPress: function onPress() {\n        return handleLogin(username, password);\n      },\n      children: _jsx(Text, {\n        style: styles.loginText,\n        children: \"LOGIN\"\n      })\n    }), _jsx(TouchableOpacity, {\n      onPress: function onPress() {\n        return navigation.navigate('Register');\n      },\n      children: _jsx(Text, {\n        style: styles.signupText,\n        children: \"Don't have an account? Sign up now\"\n      })\n    }), msg ? _jsx(Text, {\n      style: styles.errorMessage,\n      children: msg\n    }) : null]\n  });\n};\nexport default LoginScreen;","map":{"version":3,"names":["React","useState","View","Text","TextInput","TouchableOpacity","styles","SQLite","FileSystem","jsx","_jsx","jsxs","_jsxs","DATABASE_NAME","deleteAsync","documentDirectory","then","console","log","catch","error","initDatabase","db","openDatabase","transaction","tx","executeSql","window","addEventListener","deleteDatabase","result","LoginScreen","_ref","navigation","_useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","_useState5","_useState6","msg","setMsg","handleLogin","_ref2","_asyncToGenerator","_ref3","_ref3$rows","rows","length","_array","navigate","_x","_x2","apply","arguments","style","container_login","children","logo","inputView","inputText","placeholder","placeholderTextColor","onChangeText","text","value","secureTextEntry","loginBtn","onPress","loginText","signupText","errorMessage"],"sources":["D:/BKU/Đồ án đa ngành/FirstReactNative/src/screens/Login.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { View, Text, TextInput, TouchableOpacity, StyleSheet } from 'react-native';\r\nimport styles from '../../elements/style';\r\n;\r\n\r\nimport * as SQLite from 'expo-sqlite'\r\nimport * as FileSystem from 'expo-file-system';\r\ninterface ILoginProps {\r\n    navigation: any;\r\n}\r\nconst DATABASE_NAME = 'smarthome.db';\r\n\r\n// Delete the previous database and create a new database instance\r\nFileSystem.deleteAsync(FileSystem.documentDirectory + DATABASE_NAME)\r\n  .then(() => {\r\n    console.log('Deleted the previous database');\r\n\r\n    // Create a new database instance with the same filename\r\n\r\n    // ... code to create the initial database schema and insert data goes here ...\r\n  })\r\n  .catch((error) => {\r\n    console.log('Error deleting the previous database:', error);\r\n  });\r\nexport const initDatabase = () => {\r\n    const db = SQLite.openDatabase('smarthome.db');\r\n  \r\n    db.transaction(tx => {\r\n      // Create the users table\r\n      tx.executeSql(\r\n        'CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT, password TEXT)'\r\n      );\r\n  \r\n      // Insert some sample users\r\n      tx.executeSql('INSERT INTO users (username, password) VALUES (?, ?)', [\r\n        'user1',\r\n        'password1',\r\n      ]);\r\n      tx.executeSql('INSERT INTO users (username, password) VALUES (?, ?)', [\r\n        'user2',\r\n        'password2',\r\n      ]);\r\n    });\r\n    window.addEventListener('beforeunload', () => {\r\n        SQLite.deleteDatabase('smarthome.db', (result) => {\r\n            if (result) {\r\n              console.log('All databases deleted successfully');\r\n            } else {\r\n              console.log('Failed to delete databases');\r\n            }\r\n          }, (error) => {\r\n            console.log('Error deleting databases:', error);\r\n          });\r\n      });\r\n      \r\n  \r\n    return db;\r\n  };\r\nconst LoginScreen: React.FC<ILoginProps> = ({ navigation }) => {\r\n    const [username, setUsername] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [msg, setMsg] = useState('');\r\n    const db = SQLite.openDatabase('smarthome.db');\r\n\r\nconst handleLogin = async(username: string, password: string) => {\r\n    const db=initDatabase()\r\n\r\n    db.transaction(tx => {\r\n        tx.executeSql(\r\n        'SELECT username FROM users WHERE username = ? AND password = ?',\r\n        [username, password],\r\n        (tx, { rows: { length, _array } }) => {\r\n            if (length > 0) {\r\n            // user found, navigate to the home screen\r\n            navigation.navigate('Home');\r\n            } else {\r\n            // user not found, display an error message\r\n            setMsg('Invalid username or password');\r\n            console.log(msg)\r\n            }\r\n        },\r\n        error => {\r\n            console.log(error);\r\n            return true;\r\n      }\r\n    );\r\n  });\r\n};\r\n\r\n    return (\r\n        <View style={styles.container_login}>\r\n            <Text style={styles.logo}>Login</Text>\r\n            <TouchableOpacity style={styles.inputView}>\r\n                <TextInput\r\n                    style={styles.inputText}\r\n                    placeholder=\"Username\"\r\n                    placeholderTextColor=\"#003f5c\"\r\n                    onChangeText={text => setUsername(text)}\r\n                    value={username}\r\n                />\r\n            </TouchableOpacity>\r\n            <TouchableOpacity style={styles.inputView}>\r\n                <TextInput\r\n                    style={styles.inputText}\r\n                    placeholder=\"Password\"\r\n                    placeholderTextColor=\"#003f5c\"\r\n                    secureTextEntry={true}\r\n                    onChangeText={text => setPassword(text)}\r\n                    value={password}\r\n                />\r\n            </TouchableOpacity>\r\n            <TouchableOpacity style={styles.loginBtn} onPress={() => handleLogin(username, password)}>\r\n                <Text style={styles.loginText}>LOGIN</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity onPress={() => navigation.navigate('Register')}>\r\n                <Text style={styles.signupText}>Don't have an account? Sign up now</Text>\r\n            </TouchableOpacity>\r\n            {msg ? <Text style={styles.errorMessage}>{msg}</Text> : null}\r\n        </View>\r\n    );\r\n};\r\n\r\n\r\n\r\nexport default LoginScreen;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}